{% extends "base.html" %}

{% load wagtailcore_tags wagtailimages_tags static %}

{% block content %}

    <section>
        <div class="container mx-auto p-4 bg-gray-100 rounded-lg shadow">

            <h1>{{ page.title }}</h1>
        
            <div class="content-box-title">
                <h3 class="text-sky-800">Actus & notes</h3>
            </div>
            <div class="content-content">
                {{ page.comment|richtext }}
            </div>

            <hr class="m-6">

            <div class="content-box-title">
                <h3 class="text-sky-800">Prochains événements</h3>
            </div>

            <table class="md:min-w-[90%] divide-y divide-gray-200 shadow overflow-hidden border-b border-gray-200 sm:rounded-lg m-6 mx-auto">
                <thead class="bg-gray-50">
                <tr>
                    <th scope="col" class="thead">
                        Date
                    </th>
                    <th scope="col" class="thead">
                        Activité
                    </th>
                    <th scope="col"
                        class="thead">
                        Pupitre
                    </th>
                    <th scope="col"
                        class="thead">
                        Commentaire
                    </th>
                </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                {% for event in page.get_next_events %}
                    <tr>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ event.start_date }}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 pupitre-{{ event.pupitre }}">{{ event.name }}</td>
                        <!-- La classe pour pupitre est ajoutée dynamiquement en fonction de la valeur de event.pupitre -->
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 pupitre-{{ event.pupitre }}">
                            {{ event.pupitre }}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ event.description }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>


            <hr class="m-6">

            <div class="container mx-auto px-4">
                <div id="calendar" class="w-full sm:max-w-lg mx-auto"></div>
            </div>

            <link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/4.2.0/core/main.min.css" rel="stylesheet">
            <link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/4.2.0/daygrid/main.min.css"
                  rel="stylesheet">
            <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/4.2.0/core/main.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/4.2.0/interaction/main.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/4.2.0/daygrid/main.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/4.2.0/core/locales/fr.js"></script>

            <script>
                document.addEventListener('DOMContentLoaded', function () {
                    var calendarEl = document.getElementById('calendar');
                    var calendar = new FullCalendar.Calendar(calendarEl, {
                        plugins: ['dayGrid'],
                        events: {{ page.get_all_events | safe }},
                        locale: 'fr',
                        initialView: 'dayGridMonth',
                    });
                    calendar.render();
                });
            </script>
        </div>
    </section>
    <div class="h-24"></div>
    <style>
        .fc-view-container {
            background-color: white;
        }

        .fc-time {
            display: none;
        }

        .fc-view-container .fc-head {
            background-color: #0284C7;
            color: white;
        }
    </style>

{% endblock %}